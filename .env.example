# =============================================================================
# Shopify 翻译应用 - 环境变量配置示例
# =============================================================================
# 复制此文件为 .env 并填写实际值
# 多店铺部署文档已废弃，归档于 archive/project-cleanup-20241202/duplicate-docs/multi-shop-deployment.md（只读）

# -----------------------------------------------------------------------------
# Shopify 应用配置 (必需)
# -----------------------------------------------------------------------------
# 从 Shopify Partner Dashboard 获取
SHOPIFY_API_KEY=your_api_key_here
SHOPIFY_API_SECRET=your_api_secret_here
SHOPIFY_APP_SESSION_SECRET=your_session_secret_here

# 应用访问URL（生产环境必需）
SHOPIFY_APP_URL=https://translate.ease-joy.com

# -----------------------------------------------------------------------------
# 数据库配置
# -----------------------------------------------------------------------------
# SQLite本地数据库（开发环境）
DATABASE_URL="file:./dev.sqlite"

# PostgreSQL（生产环境推荐）
# DATABASE_URL="postgresql://user:password@host:5432/dbname"

# -----------------------------------------------------------------------------
# 翻译服务配置 (必需)
# -----------------------------------------------------------------------------
# OpenAI API密钥
GPT_API_KEY=sk-your-openai-api-key

# 自定义API端点（可选）
GPT_API_URL=https://api.openai.com/v1

# GPT模型选择（默认：gpt-4o）
GPT_MODEL=gpt-4o-mini
# 每分钟最大请求数与最小请求间隔（限速控制）
TRANSLATION_MAX_REQUESTS_PER_MINUTE=20
TRANSLATION_MIN_REQUEST_INTERVAL_MS=3000

# -----------------------------------------------------------------------------
# Redis队列配置（推荐生产环境启用）
# -----------------------------------------------------------------------------
# 是否启用Redis队列（false时使用内存队列）
REDIS_ENABLED=true

# Redis连接URL（支持Railway、Upstash等云服务）
# 格式：redis://[username]:[password]@[host]:[port]/[db]
REDIS_URL=redis://default:password@localhost:6379/0

# 队列并发数（1-10，建议2-5）
QUEUE_CONCURRENCY=2

# -----------------------------------------------------------------------------
# 多店铺配置（可选）
# -----------------------------------------------------------------------------
# 店铺标识（用于数据隔离）
SHOP_ID=shop1
SHOP_PREFIX=shop1

# 开发环境覆盖（仅本地调试，可选）
# 留空则继续使用上述配置
DEV_SHOP_ID=devshop
DEV_SHOP_PREFIX=devshop
DEV_REDIS_URL=redis://default:password@localhost:6379/13
DEV_QUEUE_ROLE=worker

# -----------------------------------------------------------------------------
# 应用环境
# -----------------------------------------------------------------------------
NODE_ENV=development

# 开发环境跳过SSL验证
NODE_TLS_REJECT_UNAUTHORIZED=0

# -----------------------------------------------------------------------------
# 日志配置
# -----------------------------------------------------------------------------
# 日志级别：error | warn | info | debug
LOG_LEVEL=info
LOGGING_LEVEL=info

# 文件日志
LOGGING_FILE_ENABLED=true

# 持久化日志
LOGGING_ENABLE_PERSISTENT_LOGGER=true
LOGGING_PERSISTENCE_LEVEL=INFO

# 日志保留天数（JSON格式）
LOGGING_RETENTION_DAYS={"ERROR":30,"WARN":15,"INFO":7,"DEBUG":3}

# -----------------------------------------------------------------------------
# 性能监控
# -----------------------------------------------------------------------------
PERFORMANCE_MONITORING=true
MEMORY_CACHE_LIMIT=100

# -----------------------------------------------------------------------------
# 错误管理
# -----------------------------------------------------------------------------
ERROR_PATTERN_COLLECTION=true
AUTO_RECOVERY_MAX_ATTEMPTS=3

# -----------------------------------------------------------------------------
# 功能开关
# -----------------------------------------------------------------------------
# 产品关联翻译（选项和元字段）
ENABLE_PRODUCT_RELATED_TRANSLATION=true

# 内链转换功能
LINK_CONVERSION_ENABLED=false
LINK_CONVERSION_STRATEGY=conservative

# -----------------------------------------------------------------------------
# 计费与额度管理
# -----------------------------------------------------------------------------
# 是否启用Shopify计费（启用后将按额度校验翻译请求）
SHOPIFY_BILLING_ENABLED=false
# 紧急情况下可开启跳过计费（仅限内部调试）
BILLING_BYPASS=false
# 订阅货币与周期
BILLING_CURRENCY=USD
BILLING_INTERVAL=EVERY_30_DAYS
# 测试模式（true 时不会真实扣费，仅限开发环境）
BILLING_TEST_MODE=true
# 订阅确认回调地址（可选，默认使用 SHOPIFY_APP_URL + /app/billing/activate）
BILLING_RETURN_URL=
# 默认订阅计划名称（需与prisma.subscriptionPlan中的name一致）
DEFAULT_PLAN=free
# 每个预扣的过期时间（毫秒）
BILLING_RESERVATION_TTL_MS=300000
# 每个字符消耗的金币倍率（可用于全局调节）
CREDIT_RATE=1.0

# -----------------------------------------------------------------------------
# API监控（可选）
# -----------------------------------------------------------------------------
API_MONITORING_ENABLED=true
API_MONITORING_OPERATIONS=""
API_MONITOR_FAILURE_WARN=0.001
API_MONITOR_FAILURE_ERROR=0.005
API_MONITOR_MIN_SAMPLE=20
API_MONITOR_P95_WARN_RATIO=1.05
API_MONITOR_P95_ERROR_RATIO=1.1

# -----------------------------------------------------------------------------
# 在线客服支持 (可选)
# -----------------------------------------------------------------------------
# 启用 Crisp 聊天组件
CHAT_ENABLED=true

# Crisp Website ID
# 从 Crisp Dashboard → Settings → Website Settings 获取
# 示例格式：742f0e8d-d24b-4d2e-a2aa-16a93e11188e
CRISP_WEBSITE_ID=your-crisp-website-id-here

# Crisp Token Secret（可选但推荐）
# 用于用户身份验证，防止冒充
# 从 Crisp Dashboard → Settings → Website Settings → Security 生成
# 留空则不启用用户验证
CRISP_TOKEN_SECRET=
